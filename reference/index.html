<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Reference - Json Model</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Json Model</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../jsonmodel/" class="nav-link">jsonModel Class</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Reference</a>
                            </li>
                            <li class="navitem">
                                <a href="../extensions/" class="nav-link">Extensions</a>
                            </li>
                            <li class="navitem">
                                <a href="../roadmap/" class="nav-link">Roadmap</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../jsonmodel/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../extensions/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#reference-materials" class="nav-link">Reference Materials</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#schema-default-behavior" class="nav-link">Schema Default Behavior</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#components-map" class="nav-link">Components Map</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#list-of-field-conditionals" class="nav-link">List of Field Conditionals</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#error-handling" class="nav-link">Error Handling</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ingesting-kwargs" class="nav-link">Ingesting Kwargs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#query-criteria" class="nav-link">Query Criteria</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="reference-materials">Reference Materials</h1>
<p><em>Documentation for model declaration and error handling for jsonModel validation</em></p>
<h2 id="schema-default-behavior">Schema Default Behavior</h2>
<p>The default behavior of a schema declaration includes validation of structure, datatype and requirements. Any of these defaults can be turned off in the specification of a field in the components map. However, for many purposes, the defaults will suffice to declare model field validation, eliminating the need for further specification in a components map.</p>
<p><strong>Schema Example</strong>::</p>
<pre><code>"schema": {
    "userID": "gY3Cv81QwL0Fs",
    "datetime": 1456000345.543713,
    "active": true,
    "emoticon": "aGFwcHk=",
    "rating": 8,
    "reference": null,
    "address": {
        "city": "New Orleans",
        "region": "LA",
        "postal_code": "",
        "country": "United States",
        "country_code": 0
    },
    "comments": [ "@GerardMaras Rock the shrimp bouillabaisse!" ]
}
</code></pre>
<h3 id="default-settings">Default Settings</h3>
<ul>
<li><strong>Structure</strong>: The validation process will assume that a dictionary (including the top-level dictionary) defines its maximum scope of key names and that lists can contain any number of items. Lists cannot contain mixed datatypes and the first item in a list defines the allowable properties of each item in the list. For this reason, all lists declared in the model must also contain an item. So, the example model expects to find only the userID, datetime, active, emoticon, rating, address and comments fields and it will accept any number of strings in the comments list.</li>
<li><strong>Datatype</strong>: The validation process will assume that the datatype of each value in the input matches the datatype in the model. So, the example model expects to see a string for userID, a number for datetime, a boolean for active, etc&hellip; Special datatypes like bytes, integers and sets which json does not directly support must be handled by qualifiers in the components map.</li>
<li><strong>Requirements</strong>: The validation process will assume a key with a non-empty value is a required input. Since lists must declare an item, all lists are assumed to be required fields in the model. So, all fields in the example are required except postal_code and country_code. The empty value for each datatype can be expressed with {}, 0, 0.0, false or &ldquo;&rdquo; and indicates that it is optional.</li>
</ul>
<h3 id="meta-model-restrictions">Meta-Model Restrictions</h3>
<p>A model validation error will occur if a key name in the schema contains an item designator pattern such as [2] or [35]. The module uses these patterns to validate inputs which contain lists of arbitrary size. As a result, there are limitations to the meta-model recursion of the module. It is not possible to use lists in model declarations which you wish to use as schemas in other model declarations.</p>
<h2 id="components-map">Components Map</h2>
<p>The default validation process can be modified, and other (less common) conditional qualifier can be added through the components map of the model. Whereas the schema map provides a transparent data architecture that is self-valid, the components map can be used to specify the conditions of acceptable data for any number of fields in the schema. The component map is an optional flat dictionary where each key in the component map designates a particular path in the schema using the dot-path (&lsquo;.&rsquo; and [0]) nomenclature of nesting and array identification.</p>
<p><strong>Components Example</strong>::</p>
<pre><code>"components": {
    ".": {
        "extra_fields": false,
        "min_size": 10,
        "max_size": 300
    },
    ".active": {
        "equal_to": false
    },
    ".userID": {
        "min_length": 13,
        "max_length": 13,
        "min_value": "1111111111111",
        "max_value": "yyyyyyyyyyyyy",
        "must_not_contain": [ "[^\\w]", "_" ],
        "field_description": "13 digit unique base 64 url safe key"
    },
    ".datetime": {
        "greater_than": 1.1,
        "less_than": 2000000000.0,
        "field_position": 1
    },
    ".emoticon": {
        "required_field": false,
        "byte_data": true,
        "example_values": [ "aGFwcHk=" ],
        "excluded_values": [ "c2Fk" ],
        "field_metadata": { "endpoint": "http://collectiveacuity.com/icons/" }
    },
    ".reference": {
        "required_field": false
    },
    ".rating": {
        "required_field": false,
        "min_value": 1,
        "max_value": 10,
        "default_value": 5,
        "excluded_values": [ 7, 9 ],
        "integer_data": true
    },
    ".address.city": {
        "discrete_values": [ "New Orleans", "New York", "Los Angeles", "Miami" ],
        "required_field": false,
        "default_value": "New York"
    },
    ".address.region":{
        "greater_than": "AB",
        "less_than": "Yyyyyyyyyyyyyyyyyyyyyyyy",
        "contains_either": [ "[A-Z]{2}", "[A-Z][a-z]+" ],
        "field_title": "State or Province"
    },
    ".address.country_code":{
        "discrete_values": [ 36, 124, 554, 826, 840 ],
        "integer_data": true
    },
    ".comments": {
        "required_field": false,
        "min_size": 1,
        "max_size": 3,
        "unique_values": true
    }
    ".comments[0]": {
        "max_length": 140,
        "must_contain": [ "[a-zA-Z]{2,}" ],
        "example_values": [ "couldn't find the place", "hidden gem!!!!" ]
    }
}
</code></pre>
<h3 id="path-definitions">Path Definitions</h3>
<p>To validate additional conditional qualifier placed on a field in the schema, the validation process looks through the schema for the value associated with a key or item specified in the key name of the components map. In this example, the key named &ldquo;.userID&rdquo; maps to the &ldquo;userID&rdquo; key to be found in the top level map of the schema, &ldquo;.address.city&rdquo; refers to the &ldquo;city&rdquo; key inside the &ldquo;address&rdquo; map inside the schema map and &ldquo;.comments[0]&rdquo; refers to the first item inside the comments list.  Since the comments list is itself made optional by the declaration &ldquo;required_field&rdquo;: false in the &ldquo;.comments&rdquo; key, this component is only validated if there is an item to validate. Otherwise, it is ignored. &ldquo;.&rdquo; is the key name for the top-level map itself and the &ldquo;extra_fields&rdquo; criterion changes the default to allow the top-level map to accept undeclared keys.<br />
<strong>NOTE:</strong> The &ldquo;.&rdquo; at the beginning of a dot-path is optional. So, a key named &ldquo;userID&rdquo; is the same as &ldquo;.userID&rdquo;.</p>
<h2 id="list-of-field-conditionals">List of Field Conditionals</h2>
<p><table>
<thead>
<tr><th>Criteria Key     </th><th>Criteria Value            </th><th>Error Code  </th><th>String  </th><th>Number  </th><th>Boolean  </th><th>Map  </th><th>List  </th><th>Status   </th><th>Description                                                                                                                                                             </th></tr>
</thead>
<tbody>
<tr><td>value_datatype   </td><td>String                    </td><td>n/a         </td><td>        </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the datatype of a value or item defined in the schema                                                                                                                   </td></tr>
<tr><td>required_field   </td><td>Boolean                   </td><td>4002        </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>available</td><td>a true boolean requires this key-value in the input                                                                                                                     </td></tr>
<tr><td>extra_fields     </td><td>Boolean                   </td><td>4003        </td><td>        </td><td>        </td><td>         </td><td>Y    </td><td>      </td><td>available</td><td>a true boolean allows map to contain undeclared keys                                                                                                                    </td></tr>
<tr><td>key_datatype     </td><td>String                    </td><td>n/a         </td><td>        </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the datatype of a key name must be a string                                                                                                                             </td></tr>
<tr><td>maximum_scope    </td><td>List                      </td><td>n/a         </td><td>        </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the maximum extent of keys allowed in a dictionary generated by extra_fields default                                                                                    </td></tr>
<tr><td>declared_value   </td><td>Any                       </td><td>n/a         </td><td>        </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the value or item defined in the schema [strings                                                                                                                        </td></tr>
<tr><td>default_value    </td><td>Any                       </td><td>n/a         </td><td>Y       </td><td>Y       </td><td>Y        </td><td>     </td><td>Y     </td><td>available</td><td>a value for an optional field when field is missing in input                                                                                                            </td></tr>
<tr><td>byte_data        </td><td>Boolean                   </td><td>4011        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a true boolean expects to see base64 byte data in the string field                                                                                                      </td></tr>
<tr><td>min_length       </td><td>Integer                   </td><td>4012        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the minimum number of characters in a string                                                                                                                            </td></tr>
<tr><td>max_length       </td><td>Integer                   </td><td>4013        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the maximum number of characters in a string                                                                                                                            </td></tr>
<tr><td>must_not_contain </td><td>List of Strings           </td><td>4014        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a list of regular expressions which should not be found in a string                                                                                                     </td></tr>
<tr><td>must_contain     </td><td>List of Strings           </td><td>4015        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a list of regular expressions which must be found in a string                                                                                                           </td></tr>
<tr><td>contains_either  </td><td>List of Strings           </td><td>4016        </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a list of regular expressions which string must match at least one                                                                                                      </td></tr>
<tr><td>integer_data     </td><td>Boolean                   </td><td>4021        </td><td>        </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a true boolean requires number to be an integer                                                                                                                         </td></tr>
<tr><td>min_value        </td><td>Number or String          </td><td>4022        </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the minimum value of a number or string                                                                                                                                 </td></tr>
<tr><td>max_value        </td><td>Number or String          </td><td>4023        </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the maximum value of a number or string                                                                                                                                 </td></tr>
<tr><td>greater_than     </td><td>Number or String          </td><td>4024        </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the value a number or string must be greater than                                                                                                                       </td></tr>
<tr><td>less_than        </td><td>Number or String          </td><td>4025        </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>the value a number or string must be less than                                                                                                                          </td></tr>
<tr><td>equal_to         </td><td>Boolean, Number or String </td><td>4026        </td><td>Y       </td><td>Y       </td><td>Y        </td><td>     </td><td>      </td><td>available</td><td>the value a number, string or boolean must equal                                                                                                                        </td></tr>
<tr><td>min_size         </td><td>Integer                   </td><td>4031        </td><td>        </td><td>        </td><td>         </td><td>Y    </td><td>Y     </td><td>available</td><td>the minimum size of a map converted to json data or the minimum number of items in a list                                                                               </td></tr>
<tr><td>max_size         </td><td>Integer                   </td><td>4032        </td><td>        </td><td>        </td><td>         </td><td>Y    </td><td>Y     </td><td>available</td><td>the maximum size of a map converted to json data or the maximum number of items in a list                                                                               </td></tr>
<tr><td>unique_values    </td><td>Boolean                   </td><td>4033        </td><td>        </td><td>        </td><td>         </td><td>     </td><td>Y     </td><td>available</td><td>a true boolean treats a list as a set of unique primitives with no duplication                                                                                          </td></tr>
<tr><td>discrete_values  </td><td>List of Strings or Numbers</td><td>4041        </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a list of values allowed                                                                                                                                                </td></tr>
<tr><td>identical_to     </td><td>String                    </td><td>            </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>         </td><td>the key name in the components map whose value the value of this component must match                                                                                   </td></tr>
<tr><td>lambda_function  </td><td>String                    </td><td>            </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>         </td><td>a single argument function which should be run to validate the value of this component / lambda_function must return true (valid) or false (invalid)                    </td></tr>
<tr><td>validation_url   </td><td>String                    </td><td>            </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>         </td><td>an uri which can be called to validate the value of this component with its input in the body of the request /  uri response must return true (valid) or false (invalid)</td></tr>
<tr><td>valid_path       </td><td>Boolean                   </td><td>            </td><td>Y       </td><td>        </td><td>         </td><td>     </td><td>      </td><td>         </td><td>a true value will check localhost to determine if file path is valid                                                                                                    </td></tr>
<tr><td>example_values   </td><td>List of Strings or Numbers</td><td>            </td><td>Y       </td><td>Y       </td><td>         </td><td>     </td><td>      </td><td>available</td><td>a list of values which satisfy all the validation requirements                                                                                                          </td></tr>
<tr><td>field_title      </td><td>String                    </td><td>n/a         </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>available</td><td>the title of the component for documentation and error reporting                                                                                                        </td></tr>
<tr><td>field_description</td><td>String                    </td><td>n/a         </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>available</td><td>a description of the component for documentation and error reporting                                                                                                    </td></tr>
<tr><td>field_position   </td><td>Integer                   </td><td>n/a         </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>available</td><td>the position of the component in an ordered array of fields                                                                                                             </td></tr>
<tr><td>field_metadata   </td><td>Map                       </td><td>n/a         </td><td>Y       </td><td>Y       </td><td>Y        </td><td>Y    </td><td>Y     </td><td>available</td><td>a dictionary for metadata about the component that passes through validation check                                                                                      </td></tr>
</tbody>
</table></p>
<h2 id="error-handling">Error Handling</h2>
<p>Errors created from improper model specification will raise a ModelValidationError with a message that is designed to help determine the source of the model declaration error. To ensure that model initialization occurs properly, no error encoding is included to handle these exceptions. However, it is expected that validation of inputs will produce errors. Otherwise, what&rsquo;s the point?! So, in addition to a text report, a dictionary has been included with the InputValidationError exception to facilitate error handling.</p>
<p><strong>Error Method Example</strong>::</p>
<pre><code>self.error = {
    'model_schema': {
        'datetime': 1456190345.543713,
        'address': {
            'country_code': 0,
            'city': 'New Orleans',
            'postal_code': '',
            'region': 'LA',
            'country': 'United States'
        },
        'comments': [ '@GerardMaras Rock the shrimp bouillabaisse!' ],
        'active': True,
        'rating': 8,
        'reference': None,
        'userID': 'gY3Cv81QwL0Fs',
        'emoticon': 'aGFwcHk=',
    },
    'input_path': '.',
    'input_criteria': {
        'required_field': True,
        'value_datatype': 'map',
        'min_size': 10,
        'max_size': 300,
        'maximum_scope': [ 'datetime', 'address', 'active', 'userID', 'comments', 'rating', 'emoticon' ],
        'extra_fields': False
    },
    'failed_test': 'extra_fields',
    'error_value': 'extraKey',
    'error_code': 4003
}
</code></pre>
<h3 id="order-of-exceptions">Order of Exceptions</h3>
<p>The validation process will raise an error as soon as it encounters one, so there is no guarantee that the error that is reported is the only error in the input. Since there is no set order to the keys in a dictionary, there is also no guaranteed a priori order to the evaluation process. However below is an overview of the order of the steps of the validation process:</p>
<p>Structure:</p>
<hr />
<ol>
<li>Input is a dictionary</li>
<li>Required keys in the input</li>
<li>Extra keys in the input</li>
<li>Value of each key in the input (recursive) <em>(see below)</em></li>
<li>Inject default values for missing optional keys</li>
</ol>
<p>Values (or Items):</p>
<hr />
<ol>
<li>Datatype of value</li>
<li>Other value qualifiers based upon datatype</li>
<li>Identity, Lambda and URL qualifiers # <strong>TODO</strong></li>
</ol>
<p>To help the process of error handling and client-server negotiation, both the schema for the model as well as the the map of conditional qualifiers for the field that raised the error are included in the error dictionary.</p>
<h2 id="ingesting-kwargs">Ingesting Kwargs</h2>
<p>The process of ingestion recursively walks the valid model searching for key-value pairs which match the keyword arguments of the input. For each match it finds, it constructs a key-value pair in the dictionary using the following rules (in order):</p>
<ol>
<li>Value in kwargs if field passes all its component validation tests</li>
<li>Default value declared for the key in the model</li>
<li>Empty value appropriate to datatype of key in the model</li>
</ol>
<p>Like the core validation method, ingestion will also walk through each item in a list field of the kwargs if the item type itself is also a list or dictionary. However, because invalid data will be replaced by empty values appropriate to the datatype declared in the model, unlike the core validation model, output data from ingest may not be model valid data. If it is desirable to ensure that the data is valid, a &lsquo;default_value&rsquo; should be declared for each key in the components section of the data model and the &lsquo;min_size&rsquo; of each list declaration should only be set to 0.</p>
<p><strong>Sample Kwargs</strong>::</p>
<pre><code>{
    "userID": "6nPbM9gTwLz3f",
    "datetime": 1449179763.312077,
    "active": false,
    "emoticon": "aGFwcHIk=",
    "comments": [ "gold", "silver", "bronze", "pewter" ],
    "address": {
        "region": "NY",
        "country": "United States"
  }
}
</code></pre>
<p><strong>Ingest Sample</strong>::</p>
<pre><code>output = jsonModel.ingest(**sample_kwargs)
</code></pre>
<p><strong>Sample Output</strong>::</p>
<pre><code>{
    'userID': '6nPbM9gTwLz3f',
    'datetime': 1449179763.312077,
    'active': False,
    'rating': 5,
    'reference': None,
    'emoticon': 'aGFwcHIk='
    'comments': ['gold', 'silver', 'bronze'],
    'address': {
        'postal_code': '',
        'city': 'New York',
        'country_code': 0,
        'region': 'NY',
        'country': 'United States'
    }
}
</code></pre>
<p><strong>Ingest Empty</strong>::</p>
<pre><code>output = jsonModel.ingest(**{})
</code></pre>
<p><strong>Empty Output</strong>::</p>
<pre><code>{
    'userID': '',
    'datetime': 0.0,
    'active': False,
    'rating': 5,
    'reference': None,
    'emoticon': ''
    'comments': [],
    'address': {
        'postal_code': '',
        'city': 'New York',
        'country_code': 0,
        'region': '',
        'country': ''
    }
}
</code></pre>
<h3 id="extra-keywords">Extra Keywords</h3>
<p>If &lsquo;extra_fields&rsquo; is declared True in the components for a dictionary in the model, then any extraneous keys in the corresponding dictionary in the kwargs will be added to the output.</p>
<h3 id="too-many-items">Too Many Items</h3>
<p>Items are only added to a list from those items in kwargs if they are valid. If the number of valid items in a list in the kwargs exceeds the &lsquo;max_size&rsquo; of the corresponding list in the model, then subsequent items are not added to the list once the list reaches its maximum size.</p>
<h2 id="query-criteria">Query Criteria</h2>
<p>Query criteria are composed of a dictionary of one or more key-value pairs, where the key names are the dot path to the fields in the model schema to be queried and the values are dictionaries containing any of the conditional operators for the query on the respective fields. Like component declarations, the &ldquo;.&rdquo; at the beginning of the dot path for a key name is optional. For fields with number, string or boolean datatypes, { &ldquo;field&rdquo;: { &ldquo;equal_to&rdquo;: &ldquo;value&rdquo; } } can be shortened to { &ldquo;field&rdquo;: &ldquo;value&rdquo; } and the class will automatically interpret the syntax as the &ldquo;equal_to&rdquo; criteria. Query criteria can be simple, such as the single field, operator and qualifier in the example in <a href="..">Home</a>, or elaborate, such as found in the provided model sample-query.json below:</p>
<p><strong>Sample Query</strong>::</p>
<pre><code>{
  ".active": {
    "value_exists": true,
    "equal_to": false
  },
  ".address": {
    "max_size": 100
  },
  ".address.country": "United States",
  ".address.city": {
    "discrete_values": [ "New Orleans", "New York", "Los Angeles", "Miami"]
  },
  ".address.country_code": {
    "discrete_values": [36, 124, 554, 826, 840],
    "integer_data": true
  },
  ".address.region": {
    "contains_either": ["[A-Z]{2}", "[A-Z][a-z]+"],
    "greater_than": "AB",
    "less_than": "Yyyyyyyyyyyyyyyyyyyyyyyy"
  },
  ".comments": {
    "max_size": 3,
    "min_size": 1,
    "unique_values": true
  },
  ".comments[0]": {
    "max_length": 140,
    "must_contain": ["[a-zA-Z]{2,}"]
  },
  ".datetime": {
    "greater_than": 1.1,
    "less_than": 2000000000.0
  },
  ".emoticon": {
    "byte_data": true,
    "excluded_values": ["c2Fk"]
  },
  ".rating": {
    "excluded_values": [7, 9],
    "max_value": 10,
    "min_value": 1
  },
  ".userID": {
    "max_length": 13,
    "max_value": "yyyyyyyyyyyyy",
    "min_length": 13,
    "min_value": "1111111111111",
    "must_not_contain": ["[^\\w]", "_"]
  }
}
</code></pre>
<p>The query method follows a similar process by which input is validated. A record whose field values evaluate to true for all criteria returns true. Otherwise, something in the record does not match one or more query criteria and the query method returns false. Because the query method returns a false as soon as it encounters a failed criteria from a dictionary of fields in the query criteria, query time will vary based upon the number of records, how many fail and how many fields are added to the query criteria.</p>
<h3 id="querying-items">Querying Items</h3>
<p>Although the query method will evaluate items nested inside lists to an arbitrary depth, it does so by evaluating all items in the list and all sub-branches of any nested lists inside the list. As a result, querying items inside lists suffers non-linear explosion. And, unlike the process of item ingestion, if any item in a list (or branch of a sub-list) evaluates to true to the criteria provided the entire list will evaluate to true. <strong>Be Warned</strong></p>
<h3 id="query-errors">Query Errors</h3>
<p>If query criteria contain fields, operators or qualifiers which are outside the scope of the model, the query method will produce a QueryValidationError.</p>
<p>To handle a QueryValidationError::</p>
<pre><code>try:
    query_results = validModel.query(invalid_criteria, test_record)
except QueryValidationError as err:
    assert isinstance(err.error['message'], str)
</code></pre>
<h3 id="query-rules-customization">Query Rules Customization</h3>
<p>When the model is initialized, it accepts an optional dictionary for customized query rules. The primary purpose of this customization is to limit query criteria validation to only those query operations which are supported by a specific query engine. Optional query rules must be structured according to the components field of the model-rules.json file and cannot contain any fields, operators or qualifiers outside the full range of the model query rules.</p>
<p><strong>Query Rules</strong>::</p>
<pre><code>{
  ".boolean_fields": {
    "identical_to": ".similar_boolean",
    "lambda_function": "",
    "validation_url": "",
    "value_exists": false,
    "equal_to": false
  },
 ".list_fields": {
    "identical_to": ".similar_list",
    "lambda_function": "",
    "max_size": 0,
    "min_size": 0,
    "unique_values": false,
    "validation_url": "",
    "value_exists": false
 },
 ".map_fields": {
    "identical_to": ".similar_map",
    "lambda_function": "",
    "max_size": 0,
    "min_size": 0,
    "validation_url": "",
    "value_exists": false
 },
 ".null_fields": {
    "identical_to": ".similar_null",
    "lambda_function": "",
    "validation_url": "",
    "value_exists": false
 },
 ".number_fields": {
    "discrete_values": [],
    "excluded_values": [],
    "greater_than": 0.0,
    "identical_to": ".similar_number",
    "integer_data": false,
    "lambda_function": "",
    "less_than": 0.0,
    "max_value": 0.0,
    "min_value": 0.0,
    "validation_url": "",
    "value_exists": false,
    "equal_to": 0.0
 },
  ".string_fields": {
    "byte_data": false,
    "contains_either": [],
    "discrete_values": [],
    "excluded_values": [],
    "greater_than": "",
    "identical_to": ".similar_string",
    "lambda_function": "",
    "less_than": "",
    "max_length": 0,
    "max_value": "",
    "min_length": 0,
    "min_value": "",
    "must_contain": [],
    "must_not_contain": [],
    "validation_url": "",
    "value_exists": false,
    "equal_to": ""
  }
}
</code></pre>
<p><em>[The lambda_function, identical_to and validation_url operators are not yet supported by the model.]</em></p>
<p>A malformed query rules argument on model initialization will produce a ModelValidationError.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
